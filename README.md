# å°ç£é£Ÿå“å®‰å…¨è¡›ç”Ÿç®¡ç†æ³• RAG çŸ¥è­˜æª¢ç´¢ç³»çµ±

## æŠ€è¡“æ£§

<div align="center">

![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
![OpenAI](https://img.shields.io/badge/OpenAI-412991?style=for-the-badge&logo=openai&logoColor=white)
![LlamaIndex](https://img.shields.io/badge/LlamaIndex-FF6B35?style=for-the-badge&logo=llama&logoColor=white)
![ChromaDB](https://img.shields.io/badge/ChromaDB-FF6B35?style=for-the-badge&logo=database&logoColor=white)
![BeautifulSoup](https://img.shields.io/badge/BeautifulSoup-3776AB?style=for-the-badge&logo=python&logoColor=white)
![Rich](https://img.shields.io/badge/Rich-000000?style=for-the-badge&logo=python&logoColor=white)

</div>

---

## ç³»çµ±ç°¡ä»‹

é€™æ˜¯ä¸€å€‹åŸºæ–¼ LlamaIndex å’Œ OpenAI çš„æª¢ç´¢å¢å¼·ç”Ÿæˆï¼ˆRAGï¼‰ç³»çµ±ï¼Œå°ˆé–€ç”¨æ–¼æŸ¥è©¢å°ç£é£Ÿå“å®‰å…¨è¡›ç”Ÿç®¡ç†æ³•çš„ç›¸é—œè¦å®šã€‚ç³»çµ±æœƒè‡ªå‹•å¾æ³•å‹™éƒ¨ç¶²ç«™æ“·å–æœ€æ–°çš„æ³•è¦å…§å®¹ï¼Œå»ºç«‹å‘é‡ç´¢å¼•ï¼Œä¸¦æä¾›æ™ºæ…§å•ç­”æœå‹™ã€‚

## åŠŸèƒ½ç‰¹è‰²

- ğŸ›ï¸ **è‡ªå‹•æ³•è¦æ“·å–**ï¼šå¾æ³•å‹™éƒ¨å®˜ç¶²å–å¾—æœ€æ–°çš„é£Ÿå“å®‰å…¨è¡›ç”Ÿç®¡ç†æ³•
- ğŸ” **æ™ºæ…§èªç¾©æœå°‹**ï¼šä½¿ç”¨å‘é‡åµŒå…¥æŠ€è¡“é€²è¡Œç²¾ç¢ºçš„æ¢æ–‡æª¢ç´¢
- ğŸ¤– **AI å•ç­”æœå‹™**ï¼šåŸºæ–¼ GPT æ¨¡å‹æä¾›å°ˆæ¥­çš„æ³•è¦è§£é‡‹
- ğŸ“Š **æŸ¥è©¢åˆ†é¡**ï¼šè‡ªå‹•è­˜åˆ¥æŸ¥è©¢é¡å‹ï¼ˆç½°å‰‡ã€æ¨™ç¤ºã€æ·»åŠ ç‰©ç­‰ï¼‰
- ğŸ’» **å‹å–„ä»‹é¢**ï¼šæä¾›äº’å‹•å¼å‘½ä»¤åˆ—ä»‹é¢å’Œæ‰¹æ¬¡è™•ç†åŠŸèƒ½

## ç’°å¢ƒéœ€æ±‚

- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- OpenAI API Key

## å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ç›¸ä¾å¥—ä»¶

```bash
pip install -r requirements.txt
```

### 2. è¨­å®šç’°å¢ƒè®Šæ•¸

è¤‡è£½ç’°å¢ƒè¨­å®šæª”æ¡ˆä¸¦è¨­å®šæ‚¨çš„ OpenAI API Keyï¼š

```bash
cp .env.template .env
```

ç·¨è¼¯ `.env` æª”æ¡ˆï¼Œè¨­å®šæ‚¨çš„ API Keyï¼š

```
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. åŸ·è¡Œç³»çµ±

#### äº’å‹•å¼æŸ¥è©¢æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰

```bash
python main.py
```

ç³»çµ±æœƒè‡ªå‹•ï¼š
1. æª¢æŸ¥ç’°å¢ƒè¨­å®š
2. ä¸‹è¼‰æ³•è¦è³‡æ–™ï¼ˆå¦‚æœå°šæœªå­˜åœ¨ï¼‰
3. å»ºç«‹å‘é‡ç´¢å¼•
4. å•Ÿå‹•äº’å‹•å¼å•ç­”ä»‹é¢

#### å–®ä¸€æŸ¥è©¢æ¨¡å¼

```bash
python main.py -q "é£Ÿå“æ·»åŠ ç‰©æœ‰ä»€éº¼é™åˆ¶ï¼Ÿ"
```

#### æ‰¹æ¬¡æŸ¥è©¢æ¨¡å¼

```bash
python main.py --batch config/query_examples.txt
```

### 4. ç³»çµ±ç®¡ç†æŒ‡ä»¤

é‡æ–°ä¸‹è¼‰æ³•è¦è³‡æ–™ï¼š
```bash
python main.py --fetch-data
```

é‡å»ºå‘é‡ç´¢å¼•ï¼š
```bash
python main.py --rebuild-index
```

é¡¯ç¤ºç´¢å¼•çµ±è¨ˆï¼š
```bash
python main.py --stats
```

## ç³»çµ±æ¶æ§‹

```
LamaIndex/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data_fetcher.py      # æ³•è¦è³‡æ–™æ“·å–
â”‚   â”œâ”€â”€ document_processor.py # æ–‡ä»¶è™•ç†å’Œåˆ†å¡Š
â”‚   â”œâ”€â”€ index_builder.py     # å‘é‡ç´¢å¼•å»ºç«‹
â”‚   â””â”€â”€ rag_system.py        # RAG æŸ¥è©¢ç³»çµ±
â”œâ”€â”€ data/                    # æ³•è¦è³‡æ–™å„²å­˜
â”œâ”€â”€ config/                  # è¨­å®šæª”å’Œç¯„ä¾‹
â”œâ”€â”€ chroma_db/              # å‘é‡è³‡æ–™åº«
â”œâ”€â”€ main.py                 # ä¸»ç¨‹å¼å…¥å£
â”œâ”€â”€ requirements.txt        # Python ç›¸ä¾å¥—ä»¶
â””â”€â”€ .env.template          # ç’°å¢ƒè¨­å®šç¯„æœ¬
```

## ä½¿ç”¨ç¯„ä¾‹

### åŸºæœ¬æŸ¥è©¢ç¯„ä¾‹

```
å•é¡Œï¼šé£Ÿå“æ·»åŠ ç‰©æœ‰ä»€éº¼ä½¿ç”¨é™åˆ¶ï¼Ÿ

å›ç­”ï¼šæ ¹æ“šé£Ÿå“å®‰å…¨è¡›ç”Ÿç®¡ç†æ³•ç¬¬18æ¢è¦å®šï¼Œé£Ÿå“æ·»åŠ ç‰©ä¹‹ä½¿ç”¨æ‡‰ç¬¦åˆä¸‹åˆ—è¦å®šï¼š
ä¸€ã€ä½¿ç”¨ç¯„åœåŠé™é‡æ¨™æº–ï¼Œæ‡‰ç¬¦åˆä¸­å¤®ä¸»ç®¡æ©Ÿé—œä¹‹è¦å®šã€‚
äºŒã€è¦æ ¼æ‡‰ç¬¦åˆä¸­å¤®ä¸»ç®¡æ©Ÿé—œæ‰€å®šé£Ÿå“æ·»åŠ ç‰©ä½¿ç”¨ç¯„åœåŠé™é‡æš¨è¦æ ¼æ¨™æº–ä¹‹è¦å®šã€‚
...

ç›¸é—œæ³•æ¢ï¼š
- ç¬¬18æ¢ (ç›¸ä¼¼åº¦: 0.892)
- ç¬¬19æ¢ (ç›¸ä¼¼åº¦: 0.764)
- ç¬¬21æ¢ (ç›¸ä¼¼åº¦: 0.723)
```

### é€²éšåŠŸèƒ½

ç³»çµ±æ”¯æ´å¤šç¨®æŸ¥è©¢é¡å‹çš„è‡ªå‹•è­˜åˆ¥å’Œå„ªåŒ–ï¼š

- **ç½°å‰‡æŸ¥è©¢**ï¼šè‡ªå‹•å¼·åŒ–å°è™•ç½°æ¢æ–‡çš„æœå°‹
- **æ¨™ç¤ºæŸ¥è©¢**ï¼šå°ˆæ³¨æ–¼æ¨™ç±¤å’ŒåŒ…è£ç›¸é—œè¦å®š
- **æ·»åŠ ç‰©æŸ¥è©¢**ï¼šé‡å°é£Ÿå“æ·»åŠ ç‰©çš„ç‰¹å®šè¦ç¯„
- **è¡›ç”ŸæŸ¥è©¢**ï¼šé—œæ³¨è¡›ç”Ÿå®‰å…¨æ¨™æº–å’Œè¦æ±‚

## é–‹ç™¼å’Œè‡ªè¨‚

### è‡ªè¨‚ç›¸é—œåº¦è©•åˆ†

åœ¨ `src/rag_system.py` ä¸­çš„ `calculate_relevance_score()` å‡½æ•¸ï¼Œæ‚¨å¯ä»¥å¯¦ä½œè‡ªå·±çš„ç›¸é—œåº¦è©•åˆ†é‚è¼¯ï¼š

```python
def calculate_relevance_score(self, query: str, sources: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
    # å¯¦ä½œæ‚¨çš„è‡ªè¨‚è©•åˆ†é‚è¼¯
    # è€ƒæ…®å› ç´ ï¼šæ¢æ–‡é¡å‹ã€ç« ç¯€ç›¸é—œæ€§ã€æ³•æ¢å±¤ç´šç­‰
    pass
```

### æ“´å……å…¶ä»–æ³•è¦

ç³»çµ±æ¶æ§‹æ”¯æ´æ“´å……å…¶ä»–æ³•è¦æ–‡ä»¶ï¼Œåªéœ€ï¼š
1. ä¿®æ”¹ `data_fetcher.py` ä»¥æ”¯æ´æ–°çš„è³‡æ–™ä¾†æº
2. èª¿æ•´ `document_processor.py` ä»¥é©æ‡‰ä¸åŒçš„æ–‡ä»¶çµæ§‹
3. æ›´æ–° `rag_system.py` çš„æŸ¥è©¢åˆ†é¡é‚è¼¯

## æŠ€è¡“ç´°ç¯€

- **åµŒå…¥æ¨¡å‹**ï¼šOpenAI text-embedding-3-small
- **èªè¨€æ¨¡å‹**ï¼šGPT-3.5-turbo
- **å‘é‡è³‡æ–™åº«**ï¼šChromaDB
- **æ–‡ä»¶åˆ†å¡Š**ï¼šä¿ç•™æ³•æ¢çµæ§‹çš„æ™ºæ…§åˆ†å¡Š
- **æª¢ç´¢ç­–ç•¥**ï¼šå‘é‡ç›¸ä¼¼åº¦ + è‡ªè¨‚ç›¸é—œåº¦è©•åˆ†

## å¸¸è¦‹å•é¡Œ

### Q: ç³»çµ±å›ç­”ä¸æº–ç¢ºæ€éº¼è¾¦ï¼Ÿ
A: å¯ä»¥å˜—è©¦ï¼š
1. èª¿æ•´æŸ¥è©¢çš„æè¿°æ–¹å¼
2. ä½¿ç”¨æ›´å…·é«”çš„æ³•å¾‹è¡“èª
3. åœ¨ `rag_system.py` ä¸­èª¿æ•´ `similarity_cutoff` åƒæ•¸

### Q: å¦‚ä½•æ›´æ–°æ³•è¦å…§å®¹ï¼Ÿ
A: åŸ·è¡Œ `python main.py --fetch-data --rebuild-index` é‡æ–°ä¸‹è¼‰ä¸¦å»ºç«‹ç´¢å¼•

### Q: èƒ½å¦æ”¯æ´å…¶ä»–æ³•è¦ï¼Ÿ
A: ç³»çµ±æ¶æ§‹æ”¯æ´æ“´å……ï¼Œéœ€è¦ä¿®æ”¹å°æ‡‰çš„è³‡æ–™æ“·å–å’Œè™•ç†æ¨¡çµ„

## è²¢ç»

æ­¡è¿æäº¤å•é¡Œå ±å‘Šå’Œæ”¹é€²å»ºè­°ï¼

## æˆæ¬Š

æœ¬å°ˆæ¡ˆåƒ…ä¾›å­¸ç¿’å’Œç ”ç©¶ä½¿ç”¨ã€‚æ³•è¦å…§å®¹ä¾†æºæ–¼ä¸­è¯æ°‘åœ‹æ³•å‹™éƒ¨ç¶²ç«™ã€‚